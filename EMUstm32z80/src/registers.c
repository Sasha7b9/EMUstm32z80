#include "registers.h"
#include "RAM.h"


/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
static uint16 regPC = 0;

uint8 prevPC = 0;

uint8 regI = 0;     // Interrupt register
uint8 regR = 0;     // Regeneration register

REGS regs;

REGS regsAlt;


//------------------------------------------------------------------------------------------------------------------------------------------------------
static uint8 *FuncRegA(void)
{
    return &regs.r8[7];
}

//------------------------------------------------------------------------------------------------------------------------------------------------------
static uint8 *FuncRegB(void)
{
    return &regs.r8[1];
}

//------------------------------------------------------------------------------------------------------------------------------------------------------
static uint8 *FuncRegC(void)
{
    return &regs.r8[0];
}

//------------------------------------------------------------------------------------------------------------------------------------------------------
static uint8 *FuncRegD(void)
{
    return &regs.r8[3];
}


//------------------------------------------------------------------------------------------------------------------------------------------------------
static uint8 *FuncRegE(void)
{
    return &regs.r8[2];
}


//------------------------------------------------------------------------------------------------------------------------------------------------------
static uint8 *FuncRegH(void)
{
    return &regs.r8[5];
}


//------------------------------------------------------------------------------------------------------------------------------------------------------
static uint8 *FuncRegL(void)
{
    return &regs.r8[4];
}


//------------------------------------------------------------------------------------------------------------------------------------------------------
static uint8 *FuncRegpHL(void)
{
    return &RAM[regs.r16[2]];
}


//------------------------------------------------------------------------------------------------------------------------------------------------------
pFuncpU8V funcsReg8[8] =
{
    FuncRegB,
    FuncRegC,
    FuncRegD,
    FuncRegE,
    FuncRegH,
    FuncRegL,
    FuncRegpHL,
    FuncRegA
};

//------------------------------------------------------------------------------------------------------------------------------------------------------
static uint16 *FuncRegSP(void)
{
    return &regs.r16[4];
}


//------------------------------------------------------------------------------------------------------------------------------------------------------
static uint16 *FuncRegHL(void)
{
    return &regs.r16[2];
}


//------------------------------------------------------------------------------------------------------------------------------------------------------
static uint16 *FuncRegDE(void)
{
    return &regs.r16[1];
}


//------------------------------------------------------------------------------------------------------------------------------------------------------
static uint16 *FuncRegBC(void)
{
    return &regs.r16[0];
}


//------------------------------------------------------------------------------------------------------------------------------------------------------
pFuncpU16V funcsRegDD[4] =
{
    FuncRegBC,
    FuncRegDE,
    FuncRegHL,
    FuncRegSP
};

//------------------------------------------------------------------------------------------------------------------------------------------------------
uint8 PCandInc(void)
{
    prevPC = RAM[regPC];
    regPC++;
    return prevPC;
}


//------------------------------------------------------------------------------------------------------------------------------------------------------
uint16 PC16andInc(void)
{
    uint8 low = RAM[regPC++];
    uint8 hi = RAM[regPC++];

    return low + hi * 256;
}
